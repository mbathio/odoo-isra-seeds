<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Vue Mobile pour Scanner QR -->
        <record id="view_mobile_qr_scanner" model="ir.ui.view">
            <field name="name">seed.mobile.qr.scanner</field>
            <field name="model">seed.lot</field>
            <field name="arch" type="xml">
                <form string="Scanner QR" create="false" edit="false">
                    <sheet>
                        <div class="o_mobile_scanner">
                            <div class="text-center mb-4">
                                <h2>üì± Scanner QR Code</h2>
                                <p class="text-muted">Scannez le QR code d'un lot de semences</p>
                            </div>
                            
                            <!-- Zone de scan -->
                            <div class="card mb-4">
                                <div class="card-body text-center">
                                    <div id="qr-scanner-container" style="width: 100%; height: 300px; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center;">
                                        <div>
                                            <i class="fa fa-qrcode fa-4x text-muted mb-3"></i>
                                            <p>Cam√©ra QR Scanner</p>
                                            <button type="button" class="btn btn-primary" onclick="startQRScanner()">
                                                <i class="fa fa-camera"/> Activer Cam√©ra
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Saisie manuelle -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>üîç Recherche Manuelle</h5>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label>R√©f√©rence du Lot</label>
                                        <input type="text" class="form-control" id="manual-lot-search" placeholder="SL-G1-2024-001"/>
                                    </div>
                                    <button type="button" class="btn btn-success btn-block" onclick="searchLot()">
                                        <i class="fa fa-search"/> Rechercher
                                    </button>
                                </div>
                            </div>
                            
                            <!-- R√©sultats -->
                            <div id="scan-results" class="mt-4" style="display: none;">
                                <div class="card">
                                    <div class="card-header bg-success text-white">
                                        <h5><i class="fa fa-check"/> Lot Trouv√©</h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="lot-info">
                                            <!-- Informations du lot affich√©es ici -->
                                        </div>
                                        <div class="mt-3">
                                            <button type="button" class="btn btn-primary mr-2" onclick="viewLotDetails()">
                                                Voir D√©tails
                                            </button>
                                            <button type="button" class="btn btn-warning mr-2" onclick="addQualityControl()">
                                                Nouveau Contr√¥le
                                            </button>
                                            <button type="button" class="btn btn-info" onclick="viewTraceability()">
                                                Tra√ßabilit√©
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Actions rapides -->
                            <div class="row mt-4">
                                <div class="col-6">
                                    <button type="button" class="btn btn-outline-primary btn-block" onclick="openLotList()">
                                        <i class="fa fa-list"/> Tous les Lots
                                    </button>
                                </div>
                                <div class="col-6">
                                    <button type="button" class="btn btn-outline-success btn-block" onclick="createNewLot()">
                                        <i class="fa fa-plus"/> Nouveau Lot
                                    </button>
                                </div>
                            </div>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Vue Mobile Compact pour Lots -->
        <record id="view_seed_lot_mobile_tree" model="ir.ui.view">
            <field name="name">seed.lot.mobile.tree</field>
            <field name="model">seed.lot</field>
            <field name="arch" type="xml">
                <tree string="Lots (Mobile)" create="false">
                    <field name="name"/>
                    <field name="variety_id"/>
                    <field name="level" widget="badge"/>
                    <field name="quantity"/>
                    <field name="status" widget="badge"/>
                    <field name="production_date"/>
                </tree>
            </field>
        </record>

        <!-- Vue Mobile pour Contr√¥les Qualit√© -->
        <record id="view_quality_control_mobile_form" model="ir.ui.view">
            <field name="name">seed.quality.control.mobile.form</field>
            <field name="model">seed.quality.control</field>
            <field name="arch" type="xml">
                <form string="Contr√¥le Qualit√© (Mobile)">
                    <header>
                        <button name="action_start_test" type="object" string="D√©marrer" 
                                class="oe_highlight" attrs="{'invisible': [('status', '!=', 'draft')]}"/>
                        <button name="action_complete_test" type="object" string="Terminer" 
                                class="oe_highlight" attrs="{'invisible': [('status', '!=', 'in_progress')]}"/>
                        <field name="status" widget="statusbar"/>
                    </header>
                    
                    <sheet>
                        <div class="o_mobile_form">
                            <group>
                                <field name="seed_lot_id" readonly="1"/>
                                <field name="control_date"/>
                                <field name="inspector_id" readonly="1"/>
                            </group>
                            
                            <!-- Tests principaux en format mobile -->
                            <div class="row">
                                <div class="col-12">
                                    <div class="card mb-3">
                                        <div class="card-header">
                                            <h6>üî¨ Tests Principaux</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label>Taux de Germination (%)</label>
                                                <field name="germination_rate" nolabel="1" class="form-control"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Puret√© Vari√©tale (%)</label>
                                                <field name="variety_purity" nolabel="1" class="form-control"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Taux d'Humidit√© (%)</label>
                                                <field name="moisture_content" nolabel="1" class="form-control"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- R√©sultat -->
                            <div class="row">
                                <div class="col-12">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <h5>R√©sultat</h5>
                                            <field name="result" widget="badge"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Observations -->
                            <field name="observations" placeholder="Observations..."/>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Vue Mobile pour Saisie Rapide Production -->
        <record id="view_production_mobile_quick_form" model="ir.ui.view">
            <field name="name">seed.production.mobile.quick.form</field>
            <field name="model">seed.production</field>
            <field name="arch" type="xml">
                <form string="Production (Mobile)">
                    <sheet>
                        <div class="o_mobile_form">
                            <group>
                                <field name="name" readonly="1"/>
                                <field name="seed_lot_id"/>
                                <field name="multiplier_id"/>
                                <field name="parcel_id"/>
                            </group>
                            
                            <!-- Dates importantes -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6>üìÖ Dates</h6>
                                </div>
                                <div class="card-body">
                                    <field name="start_date"/>
                                    <field name="sowing_date"/>
                                    <field name="harvest_date"/>
                                    <field name="end_date"/>
                                </div>
                            </div>
                            
                            <!-- Quantit√©s -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6>‚öñÔ∏è Quantit√©s</h6>
                                </div>
                                <div class="card-body">
                                    <field name="planned_quantity"/>
                                    <field name="actual_yield"/>
                                    <field name="yield_per_hectare" readonly="1"/>
                                </div>
                            </div>
                            
                            <!-- Statut et notes -->
                            <field name="status" widget="radio"/>
                            <field name="notes" placeholder="Notes..."/>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Vue Mobile Dashboard Compact -->
        <record id="view_mobile_dashboard" model="ir.ui.view">
            <field name="name">seed.mobile.dashboard</field>
            <field name="model">seed.lot</field>
            <field name="arch" type="xml">
                <form string="Dashboard Mobile" create="false" edit="false">
                    <sheet>
                        <div class="o_mobile_dashboard">
                            <!-- En-t√™te avec logo -->
                            <div class="text-center mb-4">
                                <h3>üåæ ISRA Semences</h3>
                                <p class="text-muted">Tableau de bord mobile</p>
                            </div>
                            
                            <!-- Stats rapides -->
                            <div class="row mb-4">
                                <div class="col-6">
                                    <div class="card bg-primary text-white text-center">
                                        <div class="card-body">
                                            <h4 id="mobile-total-lots">-</h4>
                                            <small>Lots Actifs</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="card bg-success text-white text-center">
                                        <div class="card-body">
                                            <h4 id="mobile-certified-lots">-</h4>
                                            <small>Certifi√©s</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Actions rapides -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h6>üöÄ Actions Rapides</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-6 mb-2">
                                            <button type="button" class="btn btn-primary btn-block btn-sm" onclick="openQRScanner()">
                                                <i class="fa fa-qrcode"/> Scanner QR
                                            </button>
                                        </div>
                                        <div class="col-6 mb-2">
                                            <button type="button" class="btn btn-success btn-block btn-sm" onclick="openLotList()">
                                                <i class="fa fa-list"/> Voir Lots
                                            </button>
                                        </div>
                                        <div class="col-6 mb-2">
                                            <button type="button" class="btn btn-warning btn-block btn-sm" onclick="createQualityControl()">
                                                <i class="fa fa-clipboard-check"/> Contr√¥le QC
                                            </button>
                                        </div>
                                        <div class="col-6 mb-2">
                                            <button type="button" class="btn btn-info btn-block btn-sm" onclick="viewProductions()">
                                                <i class="fa fa-industry"/> Productions
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Alertes -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h6>‚ö†Ô∏è Alertes</h6>
                                </div>
                                <div class="card-body">
                                    <div id="mobile-alerts">
                                        <div class="alert alert-warning alert-sm">
                                            <small><strong>Lots expirant:</strong> <span id="mobile-expiring">-</span></small>
                                        </div>
                                        <div class="alert alert-danger alert-sm">
                                            <small><strong>Contr√¥les √©chou√©s:</strong> <span id="mobile-failed-qc">-</span></small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Activit√©s r√©centes -->
                            <div class="card">
                                <div class="card-header">
                                    <h6>üìã Activit√©s R√©centes</h6>
                                </div>
                                <div class="card-body">
                                    <div id="mobile-recent-activities">
                                        <!-- Charg√© dynamiquement -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Actions Mobile -->
        <record id="action_mobile_qr_scanner" model="ir.actions.act_window">
            <field name="name">Scanner QR</field>
            <field name="res_model">seed.lot</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_mobile_qr_scanner"/>
            <field name="target">current</field>
        </record>

        <record id="action_mobile_dashboard" model="ir.actions.act_window">
            <field name="name">Dashboard Mobile</field>
            <field name="res_model">seed.lot</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_mobile_dashboard"/>
            <field name="target">current</field>
        </record>

        <record id="action_mobile_lot_list" model="ir.actions.act_window">
            <field name="name">Lots (Mobile)</field>
            <field name="res_model">seed.lot</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_seed_lot_mobile_tree"/>
            <field name="domain">[('active', '=', True)]</field>
        </record>

    </data>
</odoo>