<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Configuration Syst√®me Semences -->
        <record id="view_seed_config_settings" model="ir.ui.view">
            <field name="name">seed.config.settings</field>
            <field name="model">res.config.settings</field>
            <field name="priority">90</field>
            <field name="inherit_id" ref="base.res_config_settings_view_form"/>
            <field name="arch" type="xml">
                <xpath expr="//div[hasclass('settings')]" position="inside">
                    <div class="app_settings_block" data-string="Tra√ßabilit√© des Semences" string="Tra√ßabilit√© des Semences" data-key="isra_seeds">
                        <h2>üåæ Configuration Tra√ßabilit√© des Semences</h2>
                        
                        <!-- Param√®tres G√©n√©raux -->
                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_auto_generate_qr"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_auto_generate_qr"/>
                                    <div class="text-muted">
                                        G√©n√®re automatiquement les QR codes lors de la cr√©ation des lots
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_auto_expiry_calculation"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_auto_expiry_calculation"/>
                                    <div class="text-muted">
                                        Calcule automatiquement les dates d'expiration selon le type de culture
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_enable_genealogy_tracking"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_enable_genealogy_tracking"/>
                                    <div class="text-muted">
                                        Active le suivi g√©n√©alogique complet des lots
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_enable_weather_integration"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_enable_weather_integration"/>
                                    <div class="text-muted">
                                        Int√®gre les donn√©es m√©t√©orologiques automatiquement
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Param√®tres Qualit√© -->
                        <h3>üî¨ Contr√¥le Qualit√©</h3>
                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_default_test_method"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_default_test_method"/>
                                    <div class="text-muted">
                                        M√©thode de test par d√©faut pour les contr√¥les qualit√©
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_auto_quality_alerts"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_auto_quality_alerts"/>
                                    <div class="text-muted">
                                        Envoie des alertes automatiques en cas d'√©chec des contr√¥les
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Seuils de Qualit√© -->
                        <div class="row mt16 o_settings_container">
                            <div class="col-12">
                                <h4>Seuils de Qualit√© par Niveau</h4>
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Niveau</th>
                                            <th>Germination Min (%)</th>
                                            <th>Puret√© Min (%)</th>
                                            <th>Humidit√© Max (%)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>GO</td>
                                            <td><field name="seed_go_germination_threshold" nolabel="1"/></td>
                                            <td><field name="seed_go_purity_threshold" nolabel="1"/></td>
                                            <td><field name="seed_go_moisture_threshold" nolabel="1"/></td>
                                        </tr>
                                        <tr>
                                            <td>G1</td>
                                            <td><field name="seed_g1_germination_threshold" nolabel="1"/></td>
                                            <td><field name="seed_g1_purity_threshold" nolabel="1"/></td>
                                            <td><field name="seed_g1_moisture_threshold" nolabel="1"/></td>
                                        </tr>
                                        <tr>
                                            <td>R1</td>
                                            <td><field name="seed_r1_germination_threshold" nolabel="1"/></td>
                                            <td><field name="seed_r1_purity_threshold" nolabel="1"/></td>
                                            <td><field name="seed_r1_moisture_threshold" nolabel="1"/></td>
                                        </tr>
                                        <tr>
                                            <td>R2</td>
                                            <td><field name="seed_r2_germination_threshold" nolabel="1"/></td>
                                            <td><field name="seed_r2_purity_threshold" nolabel="1"/></td>
                                            <td><field name="seed_r2_moisture_threshold" nolabel="1"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Param√®tres Notifications -->
                        <h3>üîî Notifications</h3>
                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_expiry_alert_days"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_expiry_alert_days"/>
                                    <div class="text-muted">
                                        Nombre de jours avant expiration pour d√©clencher une alerte
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_enable_email_notifications"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_enable_email_notifications"/>
                                    <div class="text-muted">
                                        Envoie des notifications par email aux responsables
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Param√®tres API -->
                        <h3>üîå API et Int√©grations</h3>
                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_enable_public_api"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_enable_public_api"/>
                                    <div class="text-muted">
                                        Active l'API publique pour les applications externes
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_weather_api_key"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_weather_api_key"/>
                                    <div class="text-muted">
                                        Cl√© API pour l'int√©gration m√©t√©orologique (OpenWeatherMap)
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Param√®tres R√©gionaux -->
                        <h3>üåç Param√®tres R√©gionaux</h3>
                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_default_region"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_default_region"/>
                                    <div class="text-muted">
                                        R√©gion par d√©faut pour les nouvelles parcelles
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_default_currency"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_default_currency"/>
                                    <div class="text-muted">
                                        Devise par d√©faut pour les contrats et co√ªts
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sauvegarde et S√©curit√© -->
                        <h3>üîí S√©curit√© et Sauvegarde</h3>
                        <div class="row mt16 o_settings_container">
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_enable_audit_log"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_enable_audit_log"/>
                                    <div class="text-muted">
                                        Active l'audit trail pour toutes les modifications
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 col-lg-6 o_setting_box">
                                <div class="o_setting_left_pane">
                                    <field name="seed_auto_backup_frequency"/>
                                </div>
                                <div class="o_setting_right_pane">
                                    <label for="seed_auto_backup_frequency"/>
                                    <div class="text-muted">
                                        Fr√©quence des sauvegardes automatiques
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Actions de Maintenance -->
                        <h3>üîß Maintenance</h3>
                        <div class="row mt16 o_settings_container">
                            <div class="col-12">
                                <div class="alert alert-info">
                                    <strong>Actions de Maintenance Syst√®me</strong>
                                    <div class="mt-2">
                                        <button type="button" class="btn btn-primary mr-2" onclick="regenerateAllQRCodes()">
                                            R√©g√©n√©rer tous les QR Codes
                                        </button>
                                        <button type="button" class="btn btn-warning mr-2" onclick="cleanupExpiredLots()">
                                            Nettoyer les lots expir√©s
                                        </button>
                                        <button type="button" class="btn btn-success mr-2" onclick="updateExpiryDates()">
                                            Recalculer dates d'expiration
                                        </button>
                                        <button type="button" class="btn btn-info" onclick="sendTestNotifications()">
                                            Test notifications
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Statistiques Syst√®me -->
                        <h3>üìä Statistiques Syst√®me</h3>
                        <div class="row mt16">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row text-center">
                                            <div class="col-3">
                                                <h4 id="stats-total-lots" class="text-primary">-</h4>
                                                <small>Total Lots</small>
                                            </div>
                                            <div class="col-3">
                                                <h4 id="stats-total-varieties" class="text-success">-</h4>
                                                <small>Vari√©t√©s</small>
                                            </div>
                                            <div class="col-3">
                                                <h4 id="stats-total-multipliers" class="text-info">-</h4>
                                                <small>Multiplicateurs</small>
                                            </div>
                                            <div class="col-3">
                                                <h4 id="stats-total-qc" class="text-warning">-</h4>
                                                <small>Contr√¥les QC</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </xpath>
            </field>
        </record>

        <!-- Vue Configuration Laboratoires -->
        <record id="view_laboratory_config" model="ir.ui.view">
            <field name="name">seed.laboratory.config</field>
            <field name="model">seed.laboratory</field>
            <field name="arch" type="xml">
                <form string="Configuration Laboratoire">
                    <sheet>
                        <group>
                            <group>
                                <field name="name" required="1"/>
                                <field name="code"/>
                                <field name="accreditation_number"/>
                                <field name="contact_person"/>
                            </group>
                            <group>
                                <field name="phone"/>
                                <field name="email"/>
                                <field name="website"/>
                                <field name="active"/>
                            </group>
                        </group>
                        
                        <field name="address" placeholder="Adresse compl√®te du laboratoire..."/>
                        
                        <notebook>
                            <page string="Capacit√©s">
                                <field name="test_capabilities" widget="many2many_tags"/>
                                <field name="equipment_list" placeholder="Liste des √©quipements disponibles..."/>
                            </page>
                            <page string="Certifications">
                                <field name="certifications" placeholder="Certifications et accr√©ditations..."/>
                                <field name="quality_standards" placeholder="Standards qualit√© suivis..."/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Vue Configuration Standards -->
        <record id="view_quality_standard_config" model="ir.ui.view">
            <field name="name">seed.quality.standard.config</field>
            <field name="model">seed.quality.standard</field>
            <field name="arch" type="xml">
                <tree string="Standards Qualit√©" editable="bottom">
                    <field name="name"/>
                    <field name="crop_type"/>
                    <field name="level"/>
                    <field name="germination_min"/>
                    <field name="purity_min"/>
                    <field name="moisture_max"/>
                    <field name="active"/>
                </tree>
            </field>
        </record>

        <!-- Actions Configuration -->
        <record id="action_seed_config_settings" model="ir.actions.act_window">
            <field name="name">Configuration Tra√ßabilit√©</field>
            <field name="res_model">res.config.settings</field>
            <field name="view_mode">form</field>
            <field name="target">inline</field>
            <field name="context">{'module': 'isra_seeds'}</field>
        </record>

        <record id="action_laboratory_config" model="ir.actions.act_window">
            <field name="name">Configuration Laboratoires</field>
            <field name="res_model">seed.laboratory</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_quality_standard_config" model="ir.actions.act_window">
            <field name="name">Standards Qualit√©</field>
            <field name="res_model">seed.quality.standard</field>
            <field name="view_mode">tree,form</field>
        </record>

    </data>
</odoo>